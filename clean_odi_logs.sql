SELECT *
FROM ALL_TABLES
WHERE OWNER = 'ODI_REPO'
ORDER BY NUM_ROWS DESC;

 

SELECT *
FROM ALL_TABLES
WHERE OWNER = 'ODI_REPO'
ORDER BY NUM_ROWS DESC;

 

ALTER TABLE "SNP_SESS_TASK_LOG" DISABLE CONSTRAINT "FK_SESS_TASK_LOG";
ALTER TABLE "SNP_SESS_STEP_LV" DISABLE CONSTRAINT "FK_SESS_STEP_LV";
ALTER TABLE "SNP_SESS_TASK_LS" DISABLE CONSTRAINT "FK_SESS_TASK_LS";

LOCK TABLE SNP_SESS_TASK_LOG IN EXCLUSIVE MODE;

TRUNCATE TABLE SNP_SESS_TASK_LS;

TRUNCATE TABLE SNP_SESS_TASK_LOG;

TRUNCATE TABLE SNP_STEP_LOG;

TRUNCATE TABLE SNP_SESS_STEP_LV;

TRUNCATE TABLE SNP_STEP_REPORT drop storage;

truncate table SNP_SCEN_REPORT;

delete from SNP_SESSION; 


ALTER TABLE "SNP_SESS_TASK_LOG" ENABLE CONSTRAINT "FK_SESS_TASK_LOG";

ALTER TABLE "SNP_SESS_STEP_LV" ENABLE CONSTRAINT "FK_SESS_STEP_LV";

ALTER TABLE "SNP_SESS_TASK_LS" ENABLE CONSTRAINT "FK_SESS_TASK_LS";


 



COMMIT; -- фиксируем удаление

 

SELECT *
FROM ALL_TABLES
WHERE OWNER = 'ODI_REPO'
ORDER BY NUM_ROWS DESC;

/

 

SELECT COUNT(*)
FROM SNP_VAR_DATA;
/

 

SELECT VAR_NAME, COUNT(*)
FROM SNP_VAR_DATA
GROUP BY VAR_NAME;
/

 

 

DELETE FROM SNP_VAR_DATA
WHERE VAR_NAME IN

(
  SELECT VAR_NAME
  FROM
  (
   SELECT VAR_NAME, COUNT(*) as AMOUNT
    FROM SNP_VAR_DATA
    GROUP BY VAR_NAME
  )
  WHERE AMOUNT > 0
)
AND
(
  (VAR_NAME, last_date) NOT IN
  (
    SELECT VAR_NAME, MAX(LAST_DATE) as last_date
    FROM SNP_VAR_DATA
    GROUP BY VAR_NAME
  )
)
/

 

COMMIT;

 

          

SELECT VAR_NAME, COUNT(*)
FROM SNP_VAR_DATA
GROUP BY VAR_NAME;


